<% content_for :title, "Articles" %>

<div class="w-full">
  <h1 class="font-bold text-2xl">Articles</h1>

  <div class="mt-3 flex items-center gap-2 text-sm">
    <span>Filter by subject:</span>
    <%= link_to "All", articles_path, class: "px-2 py-1 rounded border #{@subject ? 'bg-white hover:bg-gray-50' : 'bg-indigo-600 text-white font-semibold border-indigo-600'}" %>
    <% @subjects.each do |s| %>
      <%= link_to s, articles_path(subject: s), class: "px-2 py-1 rounded border #{s == @subject ? 'bg-indigo-600 text-white font-semibold border-indigo-600' : 'bg-white hover:bg-gray-50'}" %>
    <% end %>
  </div>

  <div class="mt-3 text-sm">
    <p>Click on an article below to read it.</p>
    <% if user_signed_in? && current_user.admin? %>
      <p class="mt-2 text-indigo-700 font-medium">
        As an admin, you can create and edit your own articles from the <%= link_to "Admin Dashboard", admin_articles_path, class: "underline hover:text-indigo-900" %>.
      </p>
    <% end %>
  </div>

  <div class="mt-6 space-y-1">
    <% @articles.each do |article| %>
      <%= link_to article_path(article), class: "block border rounded-md p-4 bg-white hover:shadow-lg hover:border-blue-400 transition no-underline" do %>
        <div class="flex flex-wrap items-center justify-between gap-2">
          <h2 class="text-xl font-semibold text-blue-600"><%= sanitize(article.title, tags: %w[em i]) %></h2>
          <div class="text-xs text-gray-500">
            <% if article.subject.present? %>
              <span class="mr-2">Subject: <%= article.subject %></span>
            <% end %>
            <% if article.published_at.present? %>
              <span><%= article.published_at.to_date.to_fs(:db) %></span>
            <% end %>
          </div>
        </div>
        <% if article.summary.present? %>
          <p class="mt-2 text-gray-700"><%= sanitize(truncate(article.summary, length: 200), tags: %w[em i]) %></p>
        <% end %>
      <% end %>
    <% end %>
  </div>

  <div class="mt-6">
    <%= paginate @articles %>
  </div>
</div>