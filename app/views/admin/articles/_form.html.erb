<%= form_with model: [:admin, @article], html: { class: "space-y-4" } do |f| %>
  <% if @article.errors.any? %>
    <div class="border border-red-200 bg-red-50 text-red-700 rounded p-3">
      <p class="font-semibold"><%= pluralize(@article.errors.count, "error") %> prohibited this article from being saved:</p>
      <ul class="list-disc ml-6 text-sm">
        <% @article.errors.full_messages.each do |m| %><li><%= m %></li><% end %>
      </ul>
    </div>
  <% end %>

  <div>
    <%= f.label :title, class: "block text-sm font-medium" %>
    <%= f.text_field :title, class: "border rounded px-2 py-1 w-full" %>
  </div>

  <div>
    <%= f.label :slug, "Slug (URL)", class: "block text-sm font-medium" %>
    <%= f.text_field :slug, class: "border rounded px-2 py-1 w-full", placeholder: "e.g., why-colors" %>
    <p class="text-xs text-gray-500 mt-1">If blank, it will be generated from the title.</p>
  </div>

  <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
    <div>
      <%= f.label :subject, class: "block text-sm font-medium" %>
      <%= f.select :subject,
                   options_for_select(Article::SUBJECTS, @article.subject),
                   { include_blank: "(none)" },
                   class: "border rounded px-2 py-1 w-full" %>
      <p class="text-xs text-gray-500 mt-1">Choose a predefined subject to keep articles organized.</p>
    </div>
    <div>
      <%= f.label :published_at, class: "block text-sm font-medium" %>
      <%= f.datetime_field :published_at, class: "border rounded px-2 py-1 w-full" %>
    </div>
  </div>

  <div>
    <%= f.label :summary, class: "block text-sm font-medium" %>
    <%= f.text_area :summary, rows: 3, class: "border rounded px-2 py-1 w-full" %>
  </div>

  <div>
    <%= f.label :body, class: "block text-sm font-medium" %>
    <%= f.text_area :body, rows: 12, class: "border rounded px-2 py-1 w-full font-mono" %>
    <details class="text-xs text-gray-700 mt-2 bg-gray-50 p-3 rounded border">
      <summary class="cursor-pointer font-semibold text-gray-800 hover:text-blue-600">ðŸ’¡ Click for HTML styling guide</summary>
      <div class="mt-2 space-y-2">
        <p><strong>Allowed HTML tags:</strong> div, p, span, br, ul, ol, li, h1-h4, strong, em, a, blockquote, code, pre, img, table, b, u, i</p>

        <p><strong>Text colors (use with &lt;span&gt;):</strong></p>
        <ul class="list-disc ml-4">
          <li><code>class="text-orange"</code> - <span style="color: #E55300;">Orange (brand color)</span></li>
          <li><code>class="text-red"</code> - <span style="color: #dc2626;">Red</span></li>
          <li><code>class="text-blue"</code> - <span style="color: #2563eb;">Blue</span></li>
          <li><code>class="text-green"</code> - <span style="color: #16a34a;">Green</span></li>
          <li><code>class="text-purple"</code> - <span style="color: #9333ea;">Purple</span></li>
        </ul>

        <p><strong>Examples:</strong></p>
        <code class="block bg-white p-2 rounded text-xs">
          &lt;p&gt;&lt;span class="text-orange"&gt;Important text&lt;/span&gt; regular text&lt;/p&gt;<br>
          &lt;h2&gt;Section Title&lt;/h2&gt;<br>
          &lt;ul&gt;&lt;li&gt;Bullet point&lt;/li&gt;&lt;/ul&gt;<br>
          &lt;a href="URL" class="text-blue-600 underline"&gt;Link text&lt;/a&gt;
        </code>
      </div>
    </details>
  </div>

  <div class="flex items-center gap-3">
    <%= f.check_box :published %>
    <%= f.label :published, "Published", class: "text-sm" %>
  </div>

  <div class="flex gap-2">
    <%= button_tag "Preview", name: "preview", value: "1", formnovalidate: true, class: "rounded px-3 py-1.5 border text-sm" %>
    <%= f.submit(@article.persisted? ? "Update" : "Create", class: "rounded px-3 py-1.5 bg-blue-600 text-white text-sm") %>
    <%= link_to "Cancel", @article.persisted? ? admin_article_path(@article) : admin_articles_path, class: "rounded px-3 py-1.5 border text-sm" %>
  </div>
<% end %>