<% content_for :title, "Admin Â· To Do List" %>

<div class="w-full">
  <div class="flex items-center justify-between mb-4">
    <h1 class="font-bold text-2xl">Admin To Do List</h1>
    <div class="flex gap-2">
      <%= link_to "Back to Admin Dashboard", admin_root_path, class: "rounded-md px-2 py-1 bg-gray-600 hover:bg-gray-500 text-white block font-medium" %>
      <%= link_to "New To Do", new_admin_admin_todo_path, class: "rounded-md px-2 py-1 bg-blue-600 hover:bg-blue-500 text-white block font-medium" %>
    </div>
  </div>

  <% if @admin_todos.any? %>
    <div class="space-y-4">
      <% pending_todos = @admin_todos.select { |t| !t.done } %>
      <% completed_todos = @admin_todos.select { |t| t.done } %>

      <% if pending_todos.any? %>
        <div>
          <h2 class="font-bold text-xl text-red-700 mb-2">Pending (<%= pending_todos.count %>)</h2>
          <div class="space-y-2">
            <% pending_todos.each do |todo| %>
              <div class="border rounded-md p-3 bg-white">
                <div class="flex items-start justify-between gap-4">
                  <div class="flex-1">
                    <div class="font-semibold text-lg"><%= todo.title %></div>
                    <% if todo.description.present? %>
                      <div class="text-sm text-gray-600 mt-1"><%= simple_format(todo.description) %></div>
                    <% end %>
                    <div class="text-xs text-gray-500 mt-2">
                      Created by <%= todo.user.display_name %> on <%= todo.created_at.to_date %>
                    </div>
                  </div>
                  <div class="flex flex-col gap-2 whitespace-nowrap">
                    <%= render "admin/shared/resource_actions", record: todo, delete: true %>
                  </div>
                </div>
              </div>
            <% end %>
          </div>
        </div>
      <% end %>

      <% if completed_todos.any? %>
        <div>
          <h2 class="font-bold text-xl text-green-700 mb-2">Completed (<%= completed_todos.count %>)</h2>
          <div class="space-y-2">
            <% completed_todos.each do |todo| %>
              <div class="border rounded-md p-3 bg-green-50">
                <div class="flex items-start justify-between gap-4">
                  <div class="flex-1">
                    <div class="font-semibold text-lg line-through text-gray-600"><%= todo.title %></div>
                    <% if todo.description.present? %>
                      <div class="text-sm text-gray-500 mt-1"><%= simple_format(todo.description) %></div>
                    <% end %>
                    <div class="text-xs text-gray-500 mt-2">
                      Created by <%= todo.user.display_name %> on <%= todo.created_at.to_date %>
                    </div>
                  </div>
                  <div class="flex flex-col gap-2 whitespace-nowrap">
                    <%= render "admin/shared/resource_actions", record: todo, delete: true %>
                  </div>
                </div>
              </div>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>

    <div class="mt-4">
      <%= paginate @admin_todos %>
    </div>
  <% else %>
    <div class="text-center my-10 p-8 bg-gray-50 rounded-md">
      <p class="text-gray-600 mb-4">No to-do items yet.</p>
      <%= link_to "Create your first To Do", new_admin_admin_todo_path, class: "rounded-md px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white inline-block font-medium" %>
    </div>
  <% end %>
</div>
